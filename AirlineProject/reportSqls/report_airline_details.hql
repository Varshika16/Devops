airline_DB.Monthly_Delay&&select month,avg(depdelay) as delay from airline_DB.stg_airline_travel where depdelay > 0 group by month
airline_DB.DayOfWeek_Delay&&select dayofweek,avg(depdelay) as delay from airline_DB.stg_airline_travel where depdelay > 0 group by dayofweek
airline_DB.HourOfDay_Delay&&select hour_details.hour, cast(avg(depdelay) as decimal(5, 2)) as delay from (select cast((case when (length(deptime) = 1 or length(deptime) = 2) then '0' when length(deptime) = 3 then substr(deptime,1,1) when length(deptime) = 4 then substr(deptime,1,2) end) as int) as hour , depdelay from airline_DB.stg_airline_travel where deptime <= 2359 and depdelay > 0 ) hour_details group by hour_details.hour
airline_DB.OldvsNew_Delay&&select p.year, avg(ab.d) as delay from airline_db.stg_airline_planedata p join (select tailnum,avg(depdelay) as d from airline_db.stg_airline_travel where depdelay > 0 and tailnum is not null group by tailnum) ab on p.tailnum = ab.tailnum where p.year is not null and p.tailnum is not null and p.year > 0 and p.year <> 'NONE' and p.year <> '' group by p.year order by delay